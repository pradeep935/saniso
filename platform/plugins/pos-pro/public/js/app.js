(()=>{function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var a,o,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function c(t,n,r,i){var c=n&&n.prototype instanceof d?n:d,l=Object.create(c.prototype);return e(l,"_invoke",function(t,e,n){var r,i,c,d=0,l=n||[],u=!1,p={p:0,n:0,v:a,a:m,f:m.bind(a,4),d:function(t,e){return r=t,i=0,c=a,p.n=e,s}};function m(t,e){for(i=t,c=e,o=0;!u&&d&&!n&&o<l.length;o++){var n,r=l[o],m=p.p,h=r[2];t>3?(n=h===e)&&(c=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=a):r[0]<=m&&((n=t<2&&m<r[1])?(i=0,p.v=e,p.n=r[1]):m<h&&(n=t<3||r[0]>e||e>h)&&(r[4]=t,r[5]=e,p.n=h,i=0))}if(n||t>1)return s;throw u=!0,e}return function(n,l,h){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&m(l,h),i=l,c=h;(o=i<2?a:c)||!u;){r||(i?i<3?(i>1&&(p.n=-1),m(i,c)):p.n=c:p.v=c);try{if(d=2,r){if(i||(n="next"),o=r[n]){if(!(o=o.call(r,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,i<2&&(i=0)}else 1===i&&(o=r.return)&&o.call(r),i<2&&(c=TypeError("The iterator does not provide a '"+n+"' method"),i=1);r=a}else if((o=(u=p.n<0)?c:t.call(e,p))!==s)break}catch(t){r=a,i=1,c=t}finally{d=1}}return{value:o,done:u}}}(t,r,i),!0),l}var s={};function d(){}function l(){}function u(){}o=Object.getPrototypeOf;var p=[][r]?o(o([][r]())):(e(o={},r,function(){return this}),o),m=u.prototype=d.prototype=Object.create(p);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,e(t,i,"GeneratorFunction")),t.prototype=Object.create(m),t}return l.prototype=u,e(m,"constructor",u),e(u,"constructor",l),l.displayName="GeneratorFunction",e(u,i,"GeneratorFunction"),e(m),e(m,i,"Generator"),e(m,r,function(){return this}),e(m,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:h}})()}function e(t,a,o,n){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}e=function(t,a,o,n){function i(a,o){e(t,a,function(t){return this._invoke(a,o,t)})}a?r?r(t,a,{value:o,enumerable:!n,configurable:!n,writable:!n}):t[a]=o:(i("next",0),i("throw",1),i("return",2))},e(t,a,o,n)}function a(t,e,a,o,n,r,i){try{var c=t[r](i),s=c.value}catch(t){return void a(t)}c.done?e(s):Promise.resolve(s).then(o,n)}function o(t){return function(){var e=this,o=arguments;return new Promise(function(n,r){var i=t.apply(e,o);function c(t){a(i,n,r,c,s,"next",t)}function s(t){a(i,n,r,c,s,"throw",t)}c(void 0)})}}function n(t){return window.trans&&window.trans[t]?window.trans[t]:t}$(document).ready(function(){$('[data-bs-toggle="tooltip"]').tooltip({placement:"top",trigger:"hover",boundary:"window"}),void 0!==window.BarcodeScanner&&(window.BarcodeScanner.init({containerId:"barcode-scanner-container",checkCameraOnInit:!1,onDetected:function(t){Botble.showSuccess(n("plugins/pos-pro::pos.barcode_detected").replace(":barcode",t));var e=$("#pos-container").data("scan-barcode-url");e?$httpClient.make().post(e,{barcode:t}).then(function(e){e.error?($("#search-product").val(t),$("#search-product").trigger("keyup"),Botble.showError(e.message||"Product not found")):e.data.auto_added?(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Product added to cart")):e.data.has_variations&&($("#search-product").val(t),$("#search-product").trigger("keyup"),Botble.showInfo(e.data.message||"Product found - please select variation"))}).catch(function(e){$("#search-product").val(t),$("#search-product").trigger("keyup"),console.error("Barcode scan API error:",e)}):($("#search-product").val(t),$("#search-product").trigger("keyup")),$("#barcode-scanner-container").slideUp(300),window.BarcodeScanner.stopScan()}}),$("#toggle-barcode-scanner").on("click",o(t().m(function e(){var a,o,r,i,c;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!(a=$("#barcode-scanner-container")).is(":visible")){t.n=1;break}a.slideUp(300),window.BarcodeScanner&&window.BarcodeScanner.stopScan().catch(function(t){console.error("Error stopping barcode scanner:",t)}),t.n=5;break;case 1:if(o=$(this),r=o.html(),o.prop("disabled",!0).html('<i class="spinner-border spinner-border-sm"></i>'),window.BarcodeScanner){t.n=2;break}return console.error("Barcode scanner not initialized"),Botble.showError(n("plugins/pos-pro::pos.scanner_not_available")),o.prop("disabled",!1).html(r),t.a(2);case 2:return t.p=2,t.n=3,window.BarcodeScanner.checkCameraPermission();case 3:i=t.v,o.prop("disabled",!1).html(r),a.slideDown(300),i&&window.BarcodeScanner.startScan().catch(function(t){console.error("Error starting barcode scanner:",t),"Camera permission denied"===t.message?Botble.showError(n("plugins/pos-pro::pos.camera_permission_denied")):Botble.showError(n("plugins/pos-pro::pos.no_camera_access"))}),t.n=5;break;case 4:t.p=4,c=t.v,o.prop("disabled",!1).html(r),console.error("Error checking camera permission:",c),Botble.showError(n("plugins/pos-pro::pos.no_camera_access")),a.slideDown(300);case 5:return t.a(2)}},e,this,[[2,4]])}))));var e=$("#fullscreen-toggle"),a=$("#fullscreen-toggle-mobile"),r=$("#fullscreen-icon"),i=$("#fullscreen-text"),c=$("#fullscreen-text-mobile"),s=$(".pos-container"),d=$("#exit-fullscreen-floating"),l=$("#mobile-menu-offcanvas"),u=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled,p=function(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()},m=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},h=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},v=e.data("fullscreen-text"),f=e.data("exit-fullscreen-text"),w=function(t){if(t){s.addClass("fullscreen-mode"),r.removeClass("ti-maximize").addClass("ti-minimize"),i.text(f),c.text(f),d.fadeIn(300).css("display","inline-flex");var e=bootstrap.Offcanvas.getInstance(l[0]);e&&e.hide()}else s.removeClass("fullscreen-mode"),r.removeClass("ti-minimize").addClass("ti-maximize"),i.text(v),c.text(v),d.fadeOut(200)};e.on("click",function(){if(u)h()?m():p(document.documentElement);else{var t=s.hasClass("fullscreen-mode");w(!t)}}),a.on("click",function(){var t=bootstrap.Offcanvas.getInstance(l[0]);t&&t.hide(),setTimeout(function(){if(u)h()?m():p(document.documentElement);else{var t=s.hasClass("fullscreen-mode");w(!t)}},300)}),d.on("click",function(){h()?m():w(!1)}),document.addEventListener("fullscreenchange",function(){w(h())}),document.addEventListener("webkitfullscreenchange",function(){w(h())}),document.addEventListener("mozfullscreenchange",function(){w(h())}),document.addEventListener("MSFullscreenChange",function(){w(h())}),$(document).on("keydown",function(t){"F11"!==t.key&&122!==t.keyCode||(t.preventDefault(),e.trigger("click"))});var g=$("#pos-container"),b={cartAdd:g.data("cart-add-url"),cartUpdate:g.data("cart-update-url"),cartRemove:g.data("cart-remove-url"),cartClear:g.data("cart-clear-url"),cartApplyCoupon:g.data("cart-apply-coupon-url"),cartRemoveCoupon:g.data("cart-remove-coupon-url"),cartUpdateShipping:g.data("cart-update-shipping-url"),cartUpdateManualDiscount:g.data("cart-update-manual-discount-url"),cartRemoveManualDiscount:g.data("cart-remove-manual-discount-url"),products:g.data("products-url"),quickShop:g.data("quick-shop-url"),checkout:g.data("checkout-url"),receipt:g.data("receipt-url")};window.updateCartDisplay=function(t){t?($("#cart-items").html(t.html||""),$('[data-bs-toggle="tooltip"]').tooltip({placement:"top",trigger:"hover",boundary:"window"}),t.customer_id&&t.customer?($("#customer-id").val(t.customer_id),$("#selected-customer-name").text(t.customer.name),$("#selected-customer-contact").html("<span>".concat(t.customer.phone||"","</span>").concat(t.customer.email?" • <span>".concat(t.customer.email,"</span>"):"")),$("#selected-customer-info").removeClass("d-none"),$("#customer-search").val(t.customer.name)):($("#customer-id").val(""),$("#selected-customer-info").addClass("d-none"),$("#customer-search").val("")),t.payment_method?$('input[name="payment_method"][value="'.concat(t.payment_method,'"]')).prop("checked",!0):$('input[name="payment_method"][value="cash"]').prop("checked",!0),t.count||0?$("#checkout-button").prop("disabled",!1).removeClass("disabled"):$("#checkout-button").prop("disabled",!0).addClass("disabled"),window.initialCart=t):console.error("Cart data is undefined or null")},window.initialCart&&window.updateCartDisplay(window.initialCart);var k,C,y=$("#search-product"),x=$("#search-icon-addon"),_=$("#search-icon");function B(t){var e=E();$httpClient.make().post(e.cartUpdateCustomer,{customer_id:t}).then(function(t){t.error&&Botble.showError(t.message)}).catch(function(t){console.error("Error saving customer to session:",t)})}function E(){var t=$("#pos-container");return{cartAdd:t.data("cart-add-url"),cartUpdate:t.data("cart-update-url"),cartRemove:t.data("cart-remove-url"),cartClear:t.data("cart-clear-url"),cartApplyCoupon:t.data("cart-apply-coupon-url"),cartRemoveCoupon:t.data("cart-remove-coupon-url"),cartUpdateShipping:t.data("cart-update-shipping-url"),cartUpdateManualDiscount:t.data("cart-update-manual-discount-url"),cartRemoveManualDiscount:t.data("cart-remove-manual-discount-url"),cartUpdateCustomer:t.data("cart-update-customer-url"),cartUpdatePaymentMethod:t.data("cart-update-payment-method-url"),products:t.data("products-url"),quickShop:t.data("quick-shop-url"),checkout:t.data("checkout-url"),receipt:t.data("receipt-url")}}function S(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=$("#customer-search-results");$.ajax({url:g.data("search-customers-url")||route("pos-pro.search-customers"),method:"GET",data:{q:t},beforeSend:function(){e.html('<div class="dropdown-item text-center"><div class="spinner-border spinner-border-sm text-primary" role="status"></div></div>')},success:function(t){if(t.data&&t.data.results){if(0===t.data.results.length)return void e.html('<div class="dropdown-item text-center text-muted">No customers found</div>');var a="";t.data.results.forEach(function(t){a+='<a href="javascript:void(0)" class="dropdown-item customer-search-item"\n                                    data-id="'.concat(t.id,'"\n                                    data-name="').concat(t.text,'"\n                                    data-phone="').concat(t.phone||"",'"\n                                    data-email="').concat(t.email||"",'">\n                                    <div class="d-flex align-items-center">\n                                        <div class="me-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" /><path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" /></svg></div>\n                                        <div>\n                                            <div class="fw-medium">').concat(t.name,'</div>\n                                            <div class="text-muted small">').concat(t.phone||""," ").concat(t.email?"• "+t.email:"","</div>\n                                        </div>\n                                    </div>\n                                </a>")}),e.html(a)}else e.html('<div class="dropdown-item text-center text-muted">Error loading customers</div>')},error:function(){e.html('<div class="dropdown-item text-center text-danger">Error loading customers</div>')}})}function M(){var t=$('input[name="delivery_option"]:checked').val(),e=$("#customer-address-section"),a=$("#delivery-option-help");"pickup"===t?(e.hide(),a.text(n("plugins/pos-pro::pos.pickup_in_store_help"))):(e.show(),a.text(n("plugins/pos-pro::pos.ship_to_address_help")))}y.val().length>0&&(_.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>'),x.css("cursor","pointer")),$(document).on("click","#confirm-add-customer-button",function(t){t.preventDefault();var e=$(this),a=$("#add-customer-modal"),o=$("#customer-name").val(),n=$("#customer-email").val(),r=$("#customer-phone").val(),i=$("#customer-address").val(),c=!1;if($(".add-customer-form .is-invalid").removeClass("is-invalid"),o||($("#customer-name").addClass("is-invalid"),c=!0),r||($("#customer-phone").addClass("is-invalid"),c=!0),!c){var s=g.data("create-customer-url");$httpClient.make().withButtonLoading(e[0]).post(s,{name:o,email:n,phone:r,address:i}).then(function(t){var e=t.data;if(e.error)Botble.showError(e.message);else{var o=e.data.customer.id,n=e.data.customer.name,r=e.data.customer.phone,i=e.data.customer.email||"";$("#customer-id").val(o),$("#selected-customer-name").text(n),$("#selected-customer-contact").html("<span>".concat(r,"</span>").concat(i?" • <span>".concat(i,"</span>"):"")),$("#selected-customer-info").removeClass("d-none"),$("#customer-name").val(""),$("#customer-email").val(""),$("#customer-phone").val(""),$("#customer-address").val(""),bootstrap.Modal.getInstance(a[0]).hide(),Botble.showSuccess(e.message)}}).catch(function(t){Botble.handleError(t)})}}),$("#search-product").on("keyup",function(){var t=$(this),e=$("#search-icon-addon"),a=$("#search-icon"),o=t.val();o.length>0?0!==a.find("svg").length&&"x"===a.data("icon")||(a.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>'),a.data("icon","x"),e.css("cursor","pointer")):"x"===a.data("icon")&&(a.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>'),a.data("icon","search"),e.css("cursor","default")),clearTimeout(k),k=setTimeout(function(){D=1,j=!0,z(o,1,!1)},500)}),$(document).on("click","#search-icon-addon",function(){var t=$("#search-icon"),e=$("#search-product");"x"===t.data("icon")&&(e.val("").focus(),t.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>'),t.data("icon","search"),$(this).css("cursor","default"),D=1,j=!0,z("",1,!1))}),$(document).on("click","#clear-search",function(){$("#search-product").val("").focus(),D=1,j=!0,z("",1,!1)}),$(document).on("keyup focus","#customer-search",function(){var t=$(this),e=$("#customer-search-results"),a=t.val().trim();clearTimeout(C),e.show(),C=setTimeout(function(){0===a.length?S(""):a.length>=1&&S(a)},300)}),$(document).on("click",function(t){$(t.target).closest("#customer-search, #customer-search-results").length||$("#customer-search-results").hide()}),$(document).on("click","#remove-selected-customer",function(){$("#customer-id").val(""),$("#selected-customer-info").addClass("d-none"),$("#customer-search").val("").focus(),B("")}),$(document).on("click",".customer-search-item",function(){var t=$(this).data("id"),e=$(this).data("name"),a=$(this).data("phone"),o=$(this).data("email");$("#customer-id").val(t),$("#selected-customer-name").text(e),$("#selected-customer-contact").html("<span>".concat(a,"</span>").concat(o?" • <span>".concat(o,"</span>"):"")),$("#selected-customer-info").removeClass("d-none"),$("#customer-search-results").hide(),$("#customer-search").val(""),B(t)}),$(window).on("scroll",function(){j&&!q&&$("#products-grid").length&&($(window).scrollTop()+$(window).height()>=$(document).height()-200&&z(F,D,!0))}),$(document).on("click","#apply-coupon-btn",function(){var t=$(this),e=$("#coupon-modal"),a=$("#coupon-code-input").val().trim(),o=$("#coupon-error-msg");if(!a)return o.text(n("plugins/pos-pro::pos.please_enter_coupon_code")),void $("#coupon-code-input").addClass("is-invalid");$httpClient.make().withButtonLoading(t[0]).post(b.cartApplyCoupon,{coupon_code:a}).then(function(t){var a=t.data;if(a.error)return o.text(a.message),void $("#coupon-code-input").addClass("is-invalid");window.updateCartDisplay(a.data.cart),Botble.showSuccess(a.message),e.modal("hide"),$("#coupon-code-input").removeClass("is-invalid")}).catch(function(t){Botble.handleError(t)})}),$(document).on("click","#remove-coupon-btn",function(){var t=$(this),e=$("#coupon-modal");$httpClient.make().withButtonLoading(t[0]).post(b.cartRemoveCoupon).then(function(t){var a=t.data;a.error?Botble.showError(a.message):(window.updateCartDisplay(a.data.cart),Botble.showSuccess(a.message),e.modal("hide"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress",".coupon-code",function(t){13===t.which&&(t.preventDefault(),$(this).closest(".coupon-form").find(".apply-coupon-code").click())}),$(document).on("keypress","#coupon-code-input",function(t){13===t.which&&(t.preventDefault(),$("#apply-coupon-btn").click())}),$("#coupon-modal").on("show.bs.modal",function(){$(this);var t=$("#coupon-code-input"),e=$("#coupon-error-msg");window.initialCart&&window.initialCart.coupon_code?t.val(window.initialCart.coupon_code):t.val(""),t.removeClass("is-invalid"),e.text("")}),$(document).on("click","#update-shipping",function(){var t=$(this),e=$("#shipping-amount").val();$httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateShipping,{shipping_amount:e}).then(function(t){var e=t.data;e.error?Botble.showError(e.message):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.message))}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress","#shipping-amount",function(t){13===t.which&&(t.preventDefault(),$("#update-shipping").click())}),$(document).on("click","#update-shipping",function(){var t=$(this),e=parseFloat($("#shipping-amount").val())||0;$httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateShipping,{shipping_amount:e}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.message||"Shipping amount updated successfully"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("click","#update-shipping-btn",function(){var t=$(this),e=$("#shipping-modal"),a=parseFloat($("#shipping-amount-input").val())||0,o=$("#shipping-error-msg");if(a<0)return o.text(n("plugins/pos-pro::pos.invalid_shipping_amount")),void $("#shipping-amount-input").addClass("is-invalid");o.text(""),$("#shipping-amount-input").removeClass("is-invalid"),$httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateShipping,{shipping_amount:a}).then(function(t){var a=t.data;if(a.error)return o.text(a.message),void $("#shipping-amount-input").addClass("is-invalid");window.updateCartDisplay(a.data.cart),Botble.showSuccess(a.message),e.modal("hide")}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress","#shipping-amount-input",function(t){13===t.which&&(t.preventDefault(),$("#update-shipping-btn").click())}),$("#shipping-modal").on("show.bs.modal",function(){$(this);var t=$("#shipping-amount-input"),e=$("#shipping-error-msg");window.initialCart?t.val(window.initialCart.shipping_amount||0):t.val(0),t.removeClass("is-invalid"),e.text("")}),$(document).on("change",'input[name="discount-type"]',function(){"percentage"===$('input[name="discount-type"]:checked').val()?$("#discount-symbol").text("%"):$("#discount-symbol").text(window.currency||"$")}),$(document).on("click","#apply-discount-btn",function(){var t=$(this),e=$("#discount-modal"),a=$("#discount-amount-input").val(),o=$("#discount-description-input").val(),r=$('input[name="discount-type"]:checked').val(),i=$("#discount-error-msg");return!a||parseFloat(a)<=0?(i.text(n("plugins/pos-pro::pos.invalid_discount_amount")),void $("#discount-amount-input").addClass("is-invalid")):"percentage"===r&&parseFloat(a)>100?(i.text(n("plugins/pos-pro::pos.percentage_discount_cannot_exceed_100")),void $("#discount-amount-input").addClass("is-invalid")):(i.text(""),$("#discount-amount-input").removeClass("is-invalid"),void $httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateManualDiscount,{discount_amount:a,discount_description:o,discount_type:r}).then(function(t){var a=t.data;if(a.error)return i.text(a.message),void $("#discount-amount-input").addClass("is-invalid");window.updateCartDisplay(a.data.cart),Botble.showSuccess(a.message),e.modal("hide")}).catch(function(t){Botble.handleError(t)}))}),$(document).on("click","#remove-discount-btn",function(){var t=$(this),e=$("#discount-modal");$httpClient.make().withButtonLoading(t[0]).post(b.cartRemoveManualDiscount).then(function(t){var a=t.data;a.error?Botble.showError(a.message):(window.updateCartDisplay(a.data.cart),Botble.showSuccess(a.message),e.modal("hide"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress","#discount-amount-input",function(t){13===t.which&&(t.preventDefault(),$("#apply-discount-btn").click())}),$("#discount-modal").on("show.bs.modal",function(){$(this);var t=$("#discount-amount-input"),e=$("#discount-description-input"),a=$("#discount-error-msg");if(window.initialCart&&window.initialCart.manual_discount>0){var o=window.initialCart.manual_discount_type||"fixed";$('input[name="discount-type"][value="'.concat(o,'"]')).prop("checked",!0).trigger("change"),t.val(window.initialCart.manual_discount_value),e.val(window.initialCart.manual_discount_description||"")}else t.val(""),e.val(""),$('input[name="discount-type"][value="fixed"]').prop("checked",!0).trigger("change");t.removeClass("is-invalid"),a.text("")}),$(document).on("click",".add-to-cart",function(){var t=$(this),e=t.data("product-id"),a=!0===t.data("has-variations"),o=t.data("url");if(a){var n=b.quickShop.replace(":id",e);$httpClient.make().withButtonLoading(t[0]).get(n).then(function(t){var e,a=t.data;$("#quick-shop-modal .modal-content").html((null===(e=a.data)||void 0===e?void 0:e.html)||a.html||""),$("#quick-shop-modal").modal("show")}).catch(function(t){Botble.handleError(t)})}else $httpClient.make().withButtonLoading(t[0]).post(o,{product_id:e,quantity:1}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Product added to cart"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("click",".update-quantity",function(t){t.preventDefault(),t.stopPropagation();var e=$(this),a=e.data("product-id"),o=e.data("quantity");if(!(o<1)){var n=b.cartUpdate;$httpClient.make().withButtonLoading(e[0]).post(n,{product_id:a,quantity:o}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Cart updated successfully"))}).catch(function(t){Botble.handleError(t)})}}),$(document).on("input",'.cart-item input[type="text"]',function(){this.value=this.value.replace(/[^0-9]/g,""),this.value&&!isNaN(parseInt(this.value,10))&&$(this).data("last-value",this.value)}),$(document).on("click",".remove-from-cart",function(t){t.preventDefault(),t.stopPropagation();var e=$(this),a=e.data("product-id"),o=b.cartRemove;$httpClient.make().withButtonLoading(e[0]).post(o,{product_id:a}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Item removed from cart"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("click","#clear-cart",function(){var t=$(this),e=b.cartClear;$httpClient.make().withButtonLoading(t[0]).post(e).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Cart cleared successfully"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("submit","#quick-shop-form",function(t){t.preventDefault();var e=$(this),a=e.find('button[type="submit"]'),o=b.cartAdd,n=e.find('input[name="product_id"]').val(),r=e.find('input[name="quantity"]').val()||1,i=[];e.find("select.variation-select").each(function(){var t=$(this).data("attribute-id"),e=$(this).val();e&&t&&(i[t]=e)}),e.find('input[type="radio"]:checked').each(function(){var t=$(this).data("attribute-id"),e=$(this).val();e&&t&&(i[t]=e)}),$httpClient.make().withButtonLoading(a[0]).post(o,{product_id:n,quantity:r,attributes:i}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):($("#quick-shop-modal").modal("hide"),window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Product added to cart"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("change",'#cart-items input[name="payment_method"]',function(){var t=$(this).val();window.selectedPaymentMethod=t,function(t){var e=E();$httpClient.make().post(e.cartUpdatePaymentMethod,{payment_method:t}).then(function(t){t.error&&Botble.showError(t.message)}).catch(function(t){console.error("Error saving payment method to session:",t)})}(t)}),$(document).on("click","#checkout-button",function(t){t.preventDefault(),t.stopPropagation();var e=$('input[name="payment_method"]:checked').val()||"cash",a=$('input[name="payment_method"]:checked').closest(".form-selectgroup-item").find(".form-selectgroup-title").text()||n("plugins/pos-pro::pos.cash"),o="cash"===e?"ti-cash":"card"===e?"ti-credit-card":"ti-wallet";$("#checkout-payment-method").val(e),$("#checkout-payment-method-info").html('<x-core::icon name="'.concat(o,'" class="me-1" /> ').concat(a));var r=$("#customer-id").val(),i=n("plugins/pos-pro::pos.guest"),c="",s="",d="";if(r&&$("#selected-customer-name").text()){i=$("#selected-customer-name").text(),c=$("#selected-customer-name").text();var l=$("#selected-customer-contact").text();if(l){var u=l.split("•");u.length>0&&(s=u[0].trim()),u.length>1&&(d=u[1].trim())}$("#checkout-customer-id").val(r),$("#checkout-customer-name").length?($("#checkout-customer-name").val(c),$("#checkout-customer-phone").val(s),$("#checkout-customer-email").val(d)):($("#checkout-form").append('<input type="hidden" id="checkout-customer-name" name="customer_name" value="'.concat(c,'">')),$("#checkout-form").append('<input type="hidden" id="checkout-customer-phone" name="customer_phone" value="'.concat(s,'">')),$("#checkout-form").append('<input type="hidden" id="checkout-customer-email" name="customer_email" value="'.concat(d,'">')))}else $("#checkout-customer-id").val(""),$("#checkout-customer-name, #checkout-customer-phone, #checkout-customer-email").remove();if($("#checkout-customer-info").text(i),function(t){var e=$("#address-form-container");e.html('\n            <div class="text-center py-3">\n                <div class="spinner-border spinner-border-sm text-primary" role="status">\n                    <span class="visually-hidden">'.concat(n("plugins/pos-pro::pos.loading"),'...</span>\n                </div>\n                <div class="mt-2 text-muted">').concat(n("plugins/pos-pro::pos.loading_address_form"),"</div>\n            </div>\n        "));var a=g.data("address-form-url")||"/admin/pos/address-form";$.ajax({url:a,method:"GET",data:{customer_id:t},success:function(t){t&&t.data&&t.data.html?e.html(t.data.html):e.html('\n                        <div class="alert alert-warning">\n                            <div class="text-muted">'.concat(n("plugins/pos-pro::pos.address_form_load_error"),"</div>\n                        </div>\n                    "))},error:function(){e.html('\n                    <div class="alert alert-danger">\n                        <div class="text-danger">'.concat(n("plugins/pos-pro::pos.address_form_load_error"),"</div>\n                    </div>\n                "))}})}(r),M(),window.initialCart){$("#modal-subtotal").text(window.initialCart.subtotal_formatted),$("#modal-tax").text(window.initialCart.tax_formatted),$("#modal-shipping").text(window.initialCart.shipping_amount_formatted),$("#modal-total").text(window.initialCart.total_formatted);var p=window.initialCart.coupon_discount&&window.initialCart.coupon_discount>0,m=$("#checkout-modal .datagrid-item.coupon-discount-row");if(p)if(0===m.length){var h=window.initialCart.coupon_code||"",v=h?'<span class="badge bg-primary-lt ms-1">'.concat(h,"</span>"):"",f='\n                        <div class="datagrid-item coupon-discount-row">\n                            <div class="datagrid-title">\n                                <div class="d-flex align-items-center">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1 text-primary"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 7.2a3 3 0 0 1 6 -2.2h2a3 3 0 0 1 6 2.2v1.8a1 1 0 0 1 -.883 .993l-.117 .007h-2v7a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1v-7h-2a1 1 0 0 1 -1 -1v-1.8z" /><path d="M9 12l2 2l4 -4" /></svg>\n                                    '.concat(n("plugins/pos-pro::pos.coupon_discount"),"\n                                    ").concat(v,'\n                                </div>\n                            </div>\n                            <div class="datagrid-content text-danger">-').concat(window.initialCart.coupon_discount_formatted,"</div>\n                        </div>\n                    ");$("#checkout-modal .datagrid-item:last").before(f)}else m.find(".datagrid-content").text("-"+window.initialCart.coupon_discount_formatted);else m.remove();var w=window.initialCart.manual_discount&&window.initialCart.manual_discount>0,b=$("#checkout-modal .datagrid-item.manual-discount-row");if(w)if(0===b.length){var k=window.initialCart.manual_discount_description||"",C=k?'<span class="badge bg-primary-lt ms-1" title="'.concat(k,'">').concat(k.length>15?k.substring(0,15)+"...":k,"</span>"):"",y='\n                        <div class="datagrid-item manual-discount-row">\n                            <div class="datagrid-title">\n                                <div class="d-flex align-items-center">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1 text-primary"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5h6a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2v-2a2 2 0 0 1 2 -2" /><path d="M9 13h6a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2v-2a2 2 0 0 1 2 -2" /><path d="M9 7l8 10" /></svg>\n                                    '.concat(n("plugins/pos-pro::pos.manual_discount"),"\n                                    ").concat(C,'\n                                </div>\n                            </div>\n                            <div class="datagrid-content text-danger">-').concat(window.initialCart.manual_discount_formatted,"</div>\n                        </div>\n                    ");$("#checkout-modal .datagrid-item:last").before(y)}else b.find(".datagrid-content").text("-"+window.initialCart.manual_discount_formatted);else b.remove()}$("#checkout-modal").modal("show")}),$(document).on("change",'input[name="delivery_option"]',function(){M()}),$(document).on("click","#complete-order-btn",function(){var t=$(this),e=$("#checkout-form");Botble.showButtonLoading(t[0]),$.ajax({url:b.checkout,method:"POST",data:e.serializeArray(),success:function(t){if(t.error)Botble.showError(t.message);else{if($("#checkout-modal").modal("hide"),Botble.showSuccess(t.message),t.data.order_ids&&t.data.order_ids.length>1){var e=t.data.orders?t.data.orders.map(function(t){return t.code}).join(", "):t.data.order_code;$("#order-number").text(e),$("#multiple-orders-info").removeClass("d-none"),$("#print-receipt-btn").data("order-ids",t.data.order_ids.join(","))}else $("#order-number").text(t.data.order_code||t.data.order.code),$("#multiple-orders-info").addClass("d-none"),$("#print-receipt-btn").data("order-ids",t.data.order_id||t.data.order.id);$("#success-modal").modal("show")}},error:function(t){Botble.handleError(t)},complete:function(){Botble.hideButtonLoading(t[0])}})});var D=1,j=!0,q=!1,F="";function z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!q&&b.products){q=!0,F=t;var o=$httpClient.make();e>1?$(".load-more-loading").removeClass("d-none"):o.withLoading($("#products-grid")[0]),o.get(b.products,{search:t,page:e}).then(function(t){var e=t.data;if(j=e.data.has_more||!1,D=e.data.next_page||D+1,a){var o=document.createElement("div");o.innerHTML=e.data.html;var n=$(o).find(".col-md-4");$("#products-grid").append(n)}else $("#products-grid").html(e.data.html||e.html||"");$(".load-more-loading").addClass("d-none"),q=!1,[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(t){return new bootstrap.Tooltip(t)})}).catch(function(t){Botble.handleError(t),q=!1,$(".load-more-loading").addClass("d-none")})}}window.updateQuantity=function(t,e){e=parseInt(e,10),(isNaN(e)||e<1)&&(e=1);var a=$('.cart-item[data-product-id="'.concat(t,'"] input')),o=b.cartUpdate;$httpClient.make().withButtonLoading(a.closest(".input-group").find("button")[0]).post(o,{product_id:t,quantity:e}).then(function(t){var o=t.data;if(o.error)return Botble.showError(o.message||"An error occurred"),void a.val(a.data("last-value")||1);a.data("last-value",e),window.updateCartDisplay(o.data.cart),Botble.showSuccess(o.data.message||"Quantity updated successfully")}).catch(function(t){Botble.handleError(t),a.val(a.data("last-value")||1)})}}),$(document).ready(function(){var t=$("#pos-container"),e={cartAdd:t.data("cart-add-url"),cartUpdate:t.data("cart-update-url"),cartRemove:t.data("cart-remove-url"),cartClear:t.data("cart-clear-url"),cartApplyCoupon:t.data("cart-apply-coupon-url"),cartRemoveCoupon:t.data("cart-remove-coupon-url"),cartUpdateShipping:t.data("cart-update-shipping-url"),cartUpdateManualDiscount:t.data("cart-update-manual-discount-url"),cartRemoveManualDiscount:t.data("cart-remove-manual-discount-url"),products:t.data("products-url"),quickShop:t.data("quick-shop-url"),checkout:t.data("checkout-url"),receipt:t.data("receipt-url")};$(document).on("click","#print-receipt-btn",function(){var t=$(this).data("order-ids")||$(this).data("order-id");t?window.open(e.receipt.replace(":id",t),"_blank"):Botble.showError("Order ID not found")}),$(document).on("click","#new-order-btn",function(){$("#success-modal").modal("hide"),clearCart()}),$("#success-modal").on("hidden.bs.modal",function(){$.ajax({url:t.data("cart-reset-customer-payment-url")||"/pos-pro/cart/reset-customer-payment",method:"POST",success:function(t){t.error||(window.updateCartDisplay(t.data.cart),Botble.showSuccess(t.message))},error:function(t){Botble.handleError(t),$.ajax({url:e.cartClear,method:"POST",success:function(t){t.error||window.updateCartDisplay(t.data.cart)}})}})}),window.clearCart=function(){$.ajax({url:e.cartClear,method:"POST",success:function(t){t.error?Botble.showError(t.message):(window.updateCartDisplay(t.data.cart),Botble.showSuccess(t.message))},error:function(t){Botble.handleError(t)}})}}),$(document).ready(function(){var t=$("#pos-container"),e=t.data("get-variation-url")||"/pos-pro/get-variation",a=t.data("product-price-url")||"/pos-pro/product-price";$(document).on("change",'.quick-shop-form .variation-select, .attribute-swatch-item input[type="radio"]',function(){var t=$(this).closest("form"),o=t.find(".variation-info"),n=t.find(".variation-price"),r=t.find(".variation-stock"),i={};t.find("select.variation-select").each(function(){var t=$(this).data("attribute-id"),e=$(this).val();if(e){i[t]=e;var a=$(this).find("option:selected").text().trim(),o=$(this).closest(".attribute-swatches-wrapper").find("label").text().replace(":","").trim();$(this).data("attribute-set-title",o),$(this).data("attribute-title",a)}}),t.find('input[type="radio"]:checked').each(function(){var t=$(this).data("attribute-id"),e=$(this).val();if(e){i[t]=e;var a=$(this).closest("label").find(".attribute-swatch-text").text().trim()||$(this).closest("label").find(".attribute-swatch-item-tooltip").text().trim(),o=$(this).closest(".attribute-swatches-wrapper").find("h4.attribute-name").text().replace(":","").trim();$(this).data("attribute-set-title",o),$(this).data("attribute-title",a)}});var c=t.find(".attribute-swatches-wrapper").length,s=Object.keys(i).length===c,d=t.data("product-id");$.ajax({url:e,method:"GET",data:{product_id:d,attributes:i},success:function(e){if(e.data&&e.data.availableAttributes&&function(t,e,a){t.find(".attribute-swatches-wrapper").each(function(){var t=$(this).find(".variation-select").data("attribute-id")||$(this).find('input[type="radio"]').first().data("attribute-id");if(!a[t]&&e[t]){var o=e[t];$(this).find("select.variation-select option").each(function(){var t=$(this).attr("value");t&&!o.includes(parseInt(t))?$(this).prop("disabled",!0):$(this).prop("disabled",!1)}),$(this).find(".attribute-swatch-item").each(function(){var t=$(this).find('input[type="radio"]').val();t&&!o.includes(parseInt(t))?($(this).addClass("disabled"),$(this).find('input[type="radio"]').prop("disabled",!0)):($(this).removeClass("disabled"),$(this).find('input[type="radio"]').prop("disabled",!1))})}})}(t,e.data.availableAttributes,i),e.data&&e.data.variation){var c=e.data.variation;t.find('input[name="product_id"]').val(c.product.id),$.get("".concat(a,"?product_id=").concat(c.product.id),function(t){n.html(t.data)}),c.product.with_storehouse_management?c.product.quantity>0?r.html('<span class="badge bg-success-lt">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5" /><path d="M12 12l8 -4.5" /><path d="M12 12l0 9" /><path d="M12 12l-8 -4.5" /></svg> '.concat(window.trans.in_stock||"In Stock",": ").concat(c.product.quantity,"\n                            </span>")):r.html('<span class="badge bg-danger-lt">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v4" /><path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z" /><path d="M12 16h.01" /></svg> '.concat(window.trans.out_of_stock||"Out of Stock","\n                            </span>")):r.html('<span class="badge bg-success-lt">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5" /><path d="M12 12l8 -4.5" /><path d="M12 12l0 9" /><path d="M12 12l-8 -4.5" /></svg> '.concat(window.trans.in_stock||"In Stock","\n                        </span>")),o.removeClass("d-none")}else s&&o.addClass("d-none")},error:function(t){Botble.handleError(t),o.addClass("d-none")}}),Object.keys(i).length||o.addClass("d-none")})})})();